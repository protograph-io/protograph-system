# Extension Development

## Rules

- Each extension must have a human readable name for error generation. This name cannot have double quotes within the string.
- The extension's grammar is an expression (the rule name is autogenerated when imported).
- Grammar fragments allow a extension developer to create their own extension rules. This however happens in the global grammar namespace (there are no localized namespaces) so use safe naming conventions like prefixing rule names with a extension prefix. One way to ensure safe names is to use `grammarBuilder.constructRuleDefinition(keyword, humanReadableName, expression)` which returns an object with a safe rule name and the corresponding safe rule declaration. Or directly use `grammarBulder.prefixer.get()` to get a safe prefix to add to your rule name.
- Make string constants case insensitive.

## Notes

- All rule names are renamed to prevent clashes, *except* in the case of grammar fragments and query objects. Query objects ("nodes", "edges", "compound nodes", etc) are not renamed because other extensions can extend one extensions query object; therefore carefully consider naming a query object; it should be intuitive enough that future developers use it but different enough to not cause object name confusion. Use plural names for query objects.
- To reference query objects (like when defining a query that accepts one type of query object), reference the object name preceded by "query_object_" (e.g. "query_object_nodes").
- To reference any query, use "query" in your grammar.


# Queries

- Queries must provide a create boolean flag for the add and create commands. When a query is provided to these commands, the query will receive `create: true` in which case the extension must create the specified object when applicable.

# Commands

- Keyword must be the same as the first command word in the grammar fragment/expression/definition for syntax highlighting.